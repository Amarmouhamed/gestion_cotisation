
<div class="container-fluid pt-4 px-4" id="print-section">
    <div class="bg-light text-center rounded p-4">
        <div class="show_print">
            <h2>{{"Tontine :"+api.user_connected.tontine.nom}}</h2>
            <p>{{"Date de début :"+api.user_connected.tontine.date_debut}}</p>
            <p>{{"Membres :"+(api.les_cotisations.encaissees?.length+api.les_cotisations.non_encaissees?.length)}}</p>
            <p>{{"Mois : "+api.selected_periode.mois+"-"+api.selected_periode.annee}}</p>
            <button styleSheetFile="assets/css/custom1.css" [useExistingCss]="true" printTitle="Gestion des cotisations" printSectionId="print-section" ngxPrint type="button" class="btn btn-outline-primary m-2 hide_print"><i class="fa fa-download me-2"></i>Télécharger rapport</button>
        </div>
        <app-inline-periode class="hide_print" [selected_id_periode]="id_periode" (periode_change)="periode_change($event)">
        </app-inline-periode>
        <div class="d-flex align-items-center justify-content-between mb-2">
            <h3 class="mb-0 ">{{"Encaissées ("+api.les_cotisations.encaissees?.length+" / "+(api.les_cotisations.encaissees?.length+api.les_cotisations.non_encaissees?.length)+")"}}
                
            </h3>
            <div class="d-md-flex ms-4">
                <button (click)="cloturer_cotisation()" class="btn btn-primary" [disabled]="loading_cloture_periode || api.selected_periode.etat_periode==1">{{loading_cloture_periode?"En cours ...":"Cloturer les cotisations"}}</button>
                <form>
                    <input name="terme_recherche" class="form-control border-0" type="search" placeholder="rechercher"
                        [(ngModel)]="filter.encaissees">
                </form>
            </div>
        </div>
        <div class="table-responsive">
            <table class="table text-start align-middle table-bordered table-hover mb-0">
                <thead>
                    <tr class="text-dark">
                        <th scope="col"><input (change)="select_all_encaissees()" [checked]="select_all.encaissees" class="form-check-input" type="checkbox"></th>
                        <th scope="col">Matricule</th>
                        <th scope="col">Prenom</th>
                        <th scope="col">Nom</th>
                        <th scope="col">Montant</th>
                        <th scope="col">Amande</th>
                        <th scope="col">Date</th>
                        <th scope="col" class="hide_print">Action</th>
                    </tr>
                </thead>
                <tbody>
                    <tr [ngClass]="{'amande': une_cotisation.montant_amande_total>0}" class="clique"  *ngFor="let une_cotisation of api.les_cotisations.encaissees| filter:filter.encaissees">
                        <td><input [checked]="une_cotisation.checked" class="form-check-input" type="checkbox"></td>
                        <td>{{une_cotisation.matricule}}</td>
                        <td>{{une_cotisation.prenom}}</td>
                        <td>{{une_cotisation.nom}}</td>
                        <td>{{une_cotisation.montant}}</td>
                        <td>{{une_cotisation.montant_amande_total}}</td>
                        <td>{{une_cotisation.created_at}}</td>
                        <td class="hide_print">
                           <button (click)="openModalWithComponent(une_cotisation)" class="btn btn-primary">détails</button> 
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <hr>
        <div class="d-flex align-items-center justify-content-between mt-4 mb-2">
            <h3 class="mb-0 text-warning">{{"Non encaissées  ("+api.les_cotisations.non_encaissees?.length+" / "+(api.les_cotisations.encaissees?.length+api.les_cotisations.non_encaissees?.length)+")"}} </h3>
            <div class="d-md-flex ms-4">
                <button [disabled]="loading_add_membre" (click)="enregistrer_cotisation()" class="btn btn-sm btn-primary m-1" [disabled]="api.selected_membres.length==0">
                    {{loading_add_membre?"En cours":"Enregistrer ("+api.selected_membres.length+") "}}
                </button>
            <form>
                <input name="terme_recherche" class="form-control border-0" type="search" placeholder="rechercher"
                    [(ngModel)]="filter.non_encaissees">
            </form>
            </div>
        </div>
        <div class="table-responsive">
            <table class="table text-start align-middle table-bordered table-hover mb-0">
                <thead>
                    <tr class="text-dark">
                        <th scope="col"><input (change)="select_all_non_encaissees()" [checked]="select_all.non_encaissees" class="form-check-input" type="checkbox"></th>
                        <th scope="col">Matricule</th>
                        <th scope="col">Prenom</th>
                        <th scope="col">Nom</th>
                        <th scope="col">Amande</th>
                        <th scope="col" class="hide_print">Montant</th>
                        <th scope="col" class="hide_print">Date</th>
                        <th scope="col" class="hide_print">Action</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="clique" [ngClass]="{'line_changed': une_cotisation.checked, 'amande': une_cotisation.montant_amande_total>0}" *ngFor="let une_cotisation of api.les_cotisations.non_encaissees | filter:filter.non_encaissees">
                        <td (click)="clique_une_cotisation_2(une_cotisation)"><input [checked]="une_cotisation.checked" class="form-check-input" type="checkbox"></td>
                        <td>{{une_cotisation.matricule}}</td>
                        <td>{{une_cotisation.prenom}}</td>
                        <td>{{une_cotisation.nom}}</td>
                        <td>{{une_cotisation.montant_amande_total}}</td>
                        <td class="hide_print">
                            <select [(ngModel)]="une_cotisation.montant" class="form-select form-select-sm" (change)="changement_select_montant(une_cotisation)">
                                <option value="undefined">Choisir le montant</option>
                                <option value="10">10 Euros</option>
                                <option value="20">20 Euros</option>
                                <option value="30">30 Euros</option>
                            </select>
                        </td>
                        <td class="hide_print">
                            <input [(ngModel)]="une_cotisation.date_cotisation" type="date" class="form-control" placeholder="date" (change)="changement_date(une_cotisation)">
                        </td>
                        <td class="hide_print">
                           <button (click)="openModalWithComponent(une_cotisation)" class="btn btn-primary">détails</button> 
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>